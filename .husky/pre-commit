#!/bin/sh
echo "ğŸ” Running pre-commit checks..."

# Run ESLint with auto-fix
echo ""
echo "ğŸ”§ Running ESLint with auto-fix..."
npm run lint -- --fix

LINT_EXIT_CODE=$?

if [ $LINT_EXIT_CODE -ne 0 ]; then
  echo "âŒ Lint errors found that could not be auto-fixed."
  echo "Please fix the errors manually and try again."
  exit 1
fi

# Re-add fixed files
git add -u

# Run type checking
echo ""
echo "ğŸ” Running type check..."
npm run typecheck

TYPE_EXIT_CODE=$?

if [ $TYPE_EXIT_CODE -ne 0 ]; then
  echo "âŒ Type check failed. Please fix type errors before committing."
  exit 1
fi

echo "âœ… All pre-commit checks passed!"
exit 0
